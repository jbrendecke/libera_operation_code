!> \file
!> \brief Brief description of the routine purpose.
!!
!! @author Routine author name(s)
!
module datcldop4
  !
  !     * feb 10/2015 - j.li.     new version for gcm18+:
  !     *                         - revised ice cloud optical properties
  !     *                           from yang et al (2012).
  !     * jun 04/2013 - j.li.   previous version datcldop2 for gcm17+:
  !     *                       - data for semi-direct effect
  !     *                         added (arrays "SOM" and "SG").
  !     * dec 15/2003 - j.li.   previous version datcldop for
  !     *                       gcm15b+.
  !
  use psizes_19, only: nbs, nbl
  implicit none
  !
  !==================================================================
  ! physical (adjustable) parameters
  !
  ! define and document here any adjustable parameters.
  ! this should be variable described using the doxygen format above as
  ! well as a description of its minimum/default/maximum.
  !
  ! here is an example,
  !
  ! real :: beta !< This is the adjustable factor for computing liquid cloud effective radius \f$[]\f$
  !           !! It is compute differently when using bulk or PAM aerosols.
  !           !! For bulk aerosols its minimum/default/maximum is (1.0/1.3/1.5).
  !==================================================================

  !     --------------------------------------------------------
  !     new water properties for sw (dobbie, li, and chylek 1999, jgr)
  !     --------------------------------------------------------
  !
  real, dimension(4, nbs), parameter :: aws = reshape( &
                      [4.554e-04,   1.500e+00,   7.190e-01,  - 9.419e-01, &
                       3.859e-04,   1.508e+00,   9.512e-01,  - 1.053e+00, &
                       - 3.946e-05,   1.538e+00,   1.035e+00,   2.638e-01, &
                       2.936e-04,   1.541e+00,   1.698e-00,   1.521e+00], [4, nbs])
  real, dimension(4, nbs), parameter :: bws = reshape( &
                      [6.481e-08,   1.553e-07,  -7.755e-10,   7.616e-12, &
                       1.072e-05,   1.345e-05,  -1.799e-08,  - 3.146e-11, &
                       4.078e-04,   2.169e-03,  -2.177e-05,   1.506e-07, &
                       2.013e-01,   1.109e-02,  -2.897e-04,   3.055e-06], [4, nbs])
  real, dimension(4, nbs, 4), parameter :: cws = reshape( &
                      [8.069e-01,   6.188e-03,  -2.065e-04,   2.352e-06, &
                       7.685e-01,   9.337e-03,  -3.101e-04,   3.527e-06, &
                       7.471e-01,   9.440e-03,  -2.616e-04,   2.614e-06, &
                       7.956e-01,   8.138e-03,  -1.861e-04,   1.611e-06, &
                       !
                       7.290E-01,   6.205E-03,  -2.107E-04,   2.396E-06, &
                       6.899E-01,   9.540E-03,  -3.199E-04,   3.648E-06, &
                       6.573E-01,   1.115E-02,  -3.307E-04,   3.502E-06, &
                       6.726E-01,   1.570E-02,  -4.480E-04,   4.718E-06, &
                       !
                       5.907E-01,   7.003E-03,  -2.395E-04,   2.698E-06, &
                       5.493E-01,   1.060E-02,  -3.547E-04,   4.033E-06, &
                       5.082E-01,   1.372E-02,  -4.134E-04,   4.474E-06, &
                       5.357E-01,   2.245E-02,  -6.470E-04,   6.882E-06, &
                       !
                       5.211E-01,   5.443E-03,  -1.913E-04,   2.144E-06, &
                       4.848E-01,   8.701E-03,  -2.965E-04,   3.391E-06, &
                       4.392E-01,   1.278E-02,  -3.930E-04,   4.349E-06, &
                       4.323E-01,   2.910E-02,  -8.812E-04,   9.701E-06], [4, nbs, 4])
  !
  !     --------------------------------------------------------
  !     new water properties for lw (lindner and li, 2000 jcl)
  !     --------------------------------------------------------
  !
  real, dimension(5, nbl), target :: awl_2str = reshape( &
                      [- .21671e-01, .79578e-03, .14899e+01, .62606e+01, - .12705e+02, &
                       - .14126e+00, .28208e-02, .35125e+01, - .34541e+01, - .22679e+01, &
                       - .18829e+00, .34065e-02, .46731e+01, - .11664e+02, .87105e+01, &
                       - .16383e+00, .26574e-02, .48670e+01, - .16442e+02, .16128e+02, &
                       - .20294e-01, .85110e-04, .28650e+01, - .11202e+02, .12047e+02, &
                       .28752e-01, - .37315e-03, .14591e+01, - .48788e+01, .49725e+01, &
                       - .40386e-01, .80822e-03, .25318e+01, - .64641e+01, .55609e+01, &
                       - .48716e-01, .81275e-03, .30390e+01, - .97845e+01, .95101e+01, &
                       .64794e-01, - .98530e-03, .12797e+01, - .55272e+01, .62599e+01], [5, nbl])
   real, dimension(5, nbl), target :: awl_4str = reshape( &
                     [-.12777E+00, 0.24567E-02, 0.32520E+01, -.23983E+01, -.15194E+01, &
                      -.19129E+00, 0.35114E-02, 0.43557E+01, -.76833E+01, 0.36398E+01, &
                      -.17543E+00, 0.29539E-02, 0.45351E+01, -.11000E+02, 0.77865E+01, &
                      -.10292E+00, 0.13068E-02, 0.39864E+01, -.11887E+02, 0.96899E+01, &
                      0.46732E-01, -.14585E-02, 0.19777E+01, -.68641E+01, 0.60287E+01, &
                      0.65364E-01, -.13199E-02, 0.86409E+00, -.25627E+01, 0.21359E+01, &
                      -.39669E-02, -.10546E-03, 0.20575E+01, -.45731E+01, 0.32646E+01, &
                      -.48441E-03, -.34869E-03, 0.23863E+01, -.66222E+01, 0.52763E+01, &
                      0.10681E+00, -.21920E-02, 0.88124E+00, -.33971E+01, 0.31257E+0], [5, nbl])
  real, dimension(4, nbl), target :: bwl_2str = reshape( &
                      [.36899e-02, - .54184e-03, .14561e-01, - .18451e-03, &
                       .62141e-02, .61190e-01, .21127e-01, - .29731e-03, &
                       .87326e-01, .29908e+00, .22928e-01, - .35569e-03, &
                       - .37551e-01, .70237e+00, .26945e-01, - .37999e-03, &
                       .51671e-01, .10199e+01, .18296e-01, - .21209e-03, &
                       .52184e+00, .72352e+00, - .48090e-02, .10414e-03, &
                       .57688e+00, .63008e+00, - .56325e-02, .87852e-04, &
                       .50346e+00, .79407e+00, - .13179e-02, .25467e-04, &
                       .67792e+00, .68259e+00, - .12136e-01, .20941e-03], [4, nbl])
  real, dimension(4, nbl), target :: bwl_4str = reshape( &
                      [ 0.52450E-02, 0.33319E-01, 0.17774E-01, -.22487E-03, &
                        -.43965E-02, 0.10964E+00, 0.22016E-01, -.30392E-03, &
                        0.50130E-01, 0.40219E+00, 0.24939E-01, -.38896E-03, &
                        -.31229E-01, 0.63407E+00, 0.26989E-01, -.38220E-03, &
                        0.59833E-01, 0.88828E+00, 0.17775E-01, -.19736E-03, &
                        0.53464E+00, 0.62145E+00, -.70677E-02, 0.15772E-03, &
                        0.61761E+00, 0.50047E+00, -.81169E-02, 0.12627E-03, &
                        0.55337E+00, 0.61333E+00, -.43286E-02, 0.70820E-04, &
                        0.67000E+00, 0.55127E+00, -.12121E-01, 0.21388E-03], [4, nbl])
  real, dimension(4, nbl), parameter :: cwl_2str = reshape( &
                      [.73147e+00, .11761e+00, .86402e-02, - .10761e-03, &
                       .81284e+00, - .60287e-01, .45367e-02, - .33372e-04, &
                       .92468e+00, - .39653e+00, .30494e-03, .20980e-04, &
                       .10006e+01, - .71422e+00, - .46784e-02, .10114e-03, &
                       .10635e+01, - .10097e+01, - .58726e-02, .97485e-04, &
                       .10762e+01, - .12482e+01, - .40343e-02, .54330e-04, &
                       .97445e+00, - .13875e+01, .79204e-03, - .27995e-04, &
                       .79053e+00, - .13566e+01, .10452e-01, - .18111e-03, &
                       .35512e+00, - .80671e+00, .30384e-01, - .47204e-03], [4, nbl])
  real, dimension(4, nbl, 4), parameter :: cwl = reshape( &
                      [0.79849E+00, -.71196E-01, 0.48274E-02, -.33720E-04, &
                       0.85309E+00, -.19444E+00, 0.18086E-02, 0.20010E-04, &
                       0.94446E+00, -.45582E+00, -.14902E-02, 0.58694E-04, &
                       0.10069E+01, -.72012E+00, -.54999E-02, 0.12365E-03, &
                       0.10568E+01, -.96702E+00, -.59762E-02, 0.10694E-03, &
                       0.10501E+01, -.11238E+01, -.26043E-02, 0.32889E-04, &
                       0.90819E+00, -.11353E+01, 0.52666E-02, -.10385E-03, &
                       0.71033E+00, -.10112E+01, 0.15699E-01, -.27011E-03, &
                       0.41230E+00, -.70905E+00, 0.30383E-01, -.48781E-03, &
                       !
                       0.70822E+00, -.29862E+00, 0.64472E-02, -.48133E-04, &
                       0.75177E+00, -.43146E+00, 0.42268E-02, -.17919E-05, &
                       0.82357E+00, -.70251E+00, 0.30549E-02, 0.33290E-05, &
                       0.85527E+00, -.92009E+00, -.14139E-03, 0.61891E-04, &
                       0.86608E+00, -.10787E+01, 0.27186E-02, -.23653E-04, &
                       0.78312E+00, -.10651E+01, 0.12964E-01, -.22552E-03, &
                       0.52328E+00, -.77058E+00, 0.26705E-01, -.44827E-03, &
                       0.23667E+00, -.36358E+00, 0.38456E-01, -.60161E-03, &
                       0.21816E-02, 0.29138E-01, 0.41274E-01, -.57094E-03, &
                       !
                       0.56354E+00, -.39139E+00, 0.99219E-02, -.78796E-04, &
                       0.60466E+00, -.52959E+00, 0.84929E-02, -.43814E-04, &
                       0.65792E+00, -.77543E+00, 0.10129E-01, -.92010E-04, &
                       0.65611E+00, -.91595E+00, 0.80375E-02, -.44795E-04, &
                       0.64070E+00, -.10072E+01, 0.12860E-01, -.17077E-03, &
                       0.51403E+00, -.89550E+00, 0.27118E-01, -.44713E-03, &
                       0.22789E+00, -.50114E+00, 0.40579E-01, -.64920E-03, &
                       -.33102E-01, -.87196E-01, 0.46931E-01, -.68598E-03, &
                       -.16362E+00, 0.17086E+00, 0.38981E-01, -.46384E-03, &
                       !
                       0.45735E+00, -.45388E+00, 0.14232E-01, -.14560E-03, &
                       0.46761E+00, -.53466E+00, 0.14794E-01, -.13999E-03, &
                       0.47778E+00, -.68464E+00, 0.19208E-01, -.22977E-03, &
                       0.44332E+00, -.72765E+00, 0.17763E-01, -.18114E-03, &
                       0.41528E+00, -.76628E+00, 0.22519E-01, -.30297E-03, &
                       0.26691E+00, -.59444E+00, 0.38533E-01, -.61142E-03, &
                       0.11676E-02, -.17706E+00, 0.48817E-01, -.74566E-03, &
                       -.18350E+00, 0.16416E+00, 0.47326E-01, -.63539E-03, &
                       -.19128E+00, 0.24875E+00, 0.29938E-01, -.26832E-03], [4, nbl, 4])
 !
  !----------------------------------------------------------------------c
  !    ice yang et al (2012) and other papers
  !----------------------------------------------------------------------c
  !
  real, dimension(3, nbs), parameter :: ais = reshape( &
                      [- 1.18563e-03,  3.10948e+00,  4.22550e-01, &
                       - 1.51415e-03,  3.14695e+00,  7.89072e-01, &
                       - 1.58226e-03,  3.15807e+00,  1.32655e+00, &
                       - 2.44181e-03,  3.23224e+00, - 5.35869e-01], [3, nbs])
  !
  real, dimension(4, nbs), parameter :: bis = reshape( &
                      [0.00000e+00,  0.00000e+00,  0.00000e+00,  0.00000e+00, &
                       5.55336e-05,  1.68582e-06,  5.13834e-08, - 2.39181e-10, &
                       - 5.70695e-04,  9.27262e-04, - 1.91293e-06, - 4.11067e-09, &
                       2.16565e-01,  2.40293e-03, - 1.48958e-05,  3.16084e-08], [4, nbs])
  !
  real, dimension(4, nbs, 4), parameter :: cis = reshape( &
                      [7.63142e-01,  7.29190e-04, -3.40745e-06,  4.90929e-09, &
                       7.67083e-01,  7.64673e-04, -3.19932e-06,  2.13641e-09, &
                       7.79390e-01,  8.58496e-04,  6.28458e-07, -2.28438e-08, &
                       8.37863e-01,  2.49720e-03, -2.07857e-05,  5.89399e-08, &
                       !
                       6.92596E-01,  1.37749E-03, -1.73395E-05,  4.50228E-08, &
                       6.90675E-01,  1.21207E-03, -1.06060E-05,  2.34397E-08, &
                       6.80736E-01,  1.97994E-03, -1.44222E-05,  3.93189E-08, &
                       7.30736E-01,  4.72452E-03, -4.45778E-05,  1.45369E-07, &
                       !
                       6.23327E-01,  2.03853E-03, -2.43037E-05,  6.23168E-08, &
                       6.14721E-01,  2.04851E-03, -1.90384E-05,  4.80105E-08, &
                       5.88141E-01,  3.44555E-03, -3.07834E-05,  9.90737E-08, &
                       6.30102E-01,  7.04638E-03, -6.98558E-05,  2.38180E-07, &
                       !
                       5.76355E-01,  2.34852E-03, -2.77992E-05,  7.10854E-08, &
                       5.61562E-01,  2.52844E-03, -2.40474E-05,  6.37843E-08, &
                       5.22132E-01,  4.37630E-03, -4.12412E-05,  1.38235E-07, &
                       5.50654E-01,  8.93813E-03, -9.05180E-05,  3.14097E-07], [4, nbs, 4])
  !
  real, dimension(3, nbl), parameter :: ail = reshape( &
                      [2.02540e-03,  1.20788e+00, - 5.18894e+00, &
                       3.98395e-03,  9.05706e-01, - 4.67086e+00, &
                       1.98364e-04,  1.42221e+00, - 5.34076e+00, &
                       1.90294e-03,  1.21485e+00, - 5.93188e+00, &
                       2.69430e-03,  1.13822e+00, - 5.96316e+00, &
                       - 2.20119e-03,  1.61583e+00, - 2.68440e+00, &
                       - 3.82619e-03,  1.87233e+00, - 5.67765e+00, &
                       3.89044e-03,  9.36813e-01, - 6.21111e+00, &
                       3.54936e-04,  1.66197e+00, - 9.11138e+00], [3, nbl])
  !
  real, dimension(4, nbl), parameter :: bil = reshape( &
                      [1.37921e-01,  8.56889e-03, - 8.65993e-05,  2.99966e-07, &
                       6.66237e-02,  8.29268e-03, - 7.29632e-05,  2.25341e-07, &
                       2.35956e-01,  6.54246e-03, - 6.68646e-05,  2.29885e-07, &
                       1.80284e-01,  6.23277e-03, - 4.90479e-05,  1.23061e-07, &
                       3.01357e-01,  1.25433e-03,  1.27937e-05, - 1.15338e-07, &
                       7.04278e-01, - 7.74161e-03,  8.85045e-05, - 3.35166e-07, &
                       4.37118e-01,  1.04128e-03, - 1.22865e-05,  4.51363e-08, &
                       1.72669e-01,  2.03051e-03,  8.69215e-06, - 1.08896e-07, &
                       8.29376e-01, - 1.28454e-02,  1.53178e-04, - 5.99546e-07], [4, nbl])
  !
  real, dimension(4, nbl, 4), parameter :: cil = reshape( &
                      [8.00261e-01,  4.92014e-03, - 4.93841e-05,  1.65647e-07, &
                       7.91123e-01,  3.74173e-03, - 2.68353e-05,  5.70346e-08, &
                       8.36067e-01,  3.94607e-03, - 3.89409e-05,  1.28266e-07, &
                       8.28938e-01,  3.14948e-03, - 2.21697e-05,  4.41066e-08, &
                       8.49846e-01,  2.69027e-03, - 1.80754e-05,  3.35259e-08, &
                       8.13868e-01,  5.04407e-03, - 5.83380e-05,  2.23192e-07, &
                       7.16168e-01,  7.14899e-03, - 7.78069e-05,  2.82136e-07, &
                       6.69258e-01,  5.67438e-03, - 4.77196e-05,  1.43107e-07, &
                       2.97388e-01,  2.30508e-02, - 2.86196e-04,  1.15702e-06, &
                       !
                       6.49223E-01, 8.73767E-03, -8.81477E-05, 2.98640E-07, &
                       6.34067E-01, 7.10530E-03, -5.80692E-05, 1.56647E-07, &
                       6.78059E-01, 8.01035E-03, -7.95545E-05, 2.64413E-07, &
                       6.57115E-01, 6.89774E-03, -5.46121E-05, 1.38060E-07, &
                       6.80564E-01, 6.22983E-03, -4.76412E-05, 1.16765E-07, &
                       6.27243E-01, 1.06343E-02, -1.22547E-04, 4.67976E-07, &
                       4.62758E-01, 1.44173E-02, -1.57722E-04, 5.76309E-07, &
                       3.76398E-01, 1.22521E-02, -1.13249E-04, 3.72437E-07, &
                       1.89152E-02, 2.72161E-02, -3.05154E-04, 1.15551E-06, &
                      !
                       5.18729E-01, 1.21220E-02, -1.23521E-04, 4.23509E-07, &
                       4.96136E-01, 1.03197E-02, -9.04207E-05, 2.68167E-07, &
                       5.29433E-01, 1.19758E-02, -1.20657E-04, 4.07561E-07, &
                       4.90320E-01, 1.09723E-02, -9.46116E-05, 2.71815E-07, &
                       5.07966E-01, 1.03747E-02, -8.82430E-05, 2.53621E-07, &
                       4.36262E-01, 1.63032E-02, -1.86497E-04, 7.08272E-07, &
                       2.43144E-01, 2.03519E-02, -2.19473E-04, 7.92776E-07, &
                       1.36795E-01, 1.72188E-02, -1.57453E-04, 5.07433E-07, &
                      -1.59512E-01, 2.75075E-02, -2.74948E-04, 9.54320E-07, &
                      !
                       4.18743E-01, 1.45679E-02, -1.47984E-04, 5.06967E-07, &
                       3.90375E-01, 1.26761E-02, -1.13709E-04, 3.47919E-07, &
                       4.01859E-01, 1.53743E-02, -1.55746E-04, 5.29665E-07, &
                       3.48664E-01, 1.44655E-02, -1.29397E-04, 3.90275E-07, &
                       3.55487E-01, 1.41095E-02, -1.25693E-04, 3.83087E-07, &
                       2.69308E-01, 2.10458E-02, -2.37584E-04, 8.93418E-07, &
                       7.87515E-02, 2.41856E-02, -2.53907E-04, 8.96674E-07, &
                      -1.41597E-02, 1.94817E-02, -1.70359E-04, 5.22266E-07, &
                      -2.07043E-01, 2.32978E-02, -1.91213E-04, 5.45479E-07], [4, nbl, 4])
  !
  !----------------------------------------------------------------------c
  !     data for semi-direct effect                                      c
  !----------------------------------------------------------------------c
  !
  real, dimension(3, nbs, 6), parameter :: som = reshape( &
                         [- 1.812647e-07, - 8.788746e-08, 2.245459e-10, &
                          - 1.759688e-08, - 5.593018e-08, 1.196204e-10, &
                          1.807199e-10, - 3.213433e-08, 1.435198e-10, &
                          - 5.908654e-09, - 8.326781e-09, 1.010342e-10, &
                          - 1.558058e-06, - 8.184194e-07, 2.021963e-10, &
                          - 1.792540e-07, - 5.585186e-07, 1.194473e-09, &
                          1.849122e-09, - 3.213511e-07, 1.435775e-09, &
                          - 5.846654e-08, - 8.333564e-08, 1.011247e-09, &
                          - 5.731912e-06, - 8.709838e-06, 1.114355e-08, &
                          - 1.813953e-06, - 5.548376e-06, 1.156957e-08, &
                          1.702879e-08, - 3.212459e-06, 1.434594e-08, &
                          - 5.849698e-07, - 8.333006e-07, 1.011067e-08, &
                          - 3.956886e-05, - 8.550318e-05, 9.049140e-08, &
                          - 1.803860e-05, - 5.450721e-05, 1.071052e-07, &
                          - 1.473983e-07, - 3.201372e-05, 1.422576e-07, &
                          - 5.853662e-06, - 8.331475e-06, 1.011652e-07, &
                          - 3.494622e-04, - 8.290733e-04, 1.342273e-06, &
                          - 1.981099e-04, - 5.253030e-04, 1.079307e-06, &
                          - 1.305448e-05, - 3.154035e-04, 1.433131e-06, &
                          - 5.908956e-05, - 8.313059e-05, 1.016754e-06, &
                          - 3.925234e-03, - 7.628457e-03, 6.051453e-05, &
                          - 2.194075e-03, - 4.910907e-03, 2.871563e-05, &
                          - 4.161093e-04, - 3.003765e-03, 1.975400e-05, &
                          - 6.442823e-04, - 8.132657e-04, 1.062579e-05], [3, nbs, 6])

  real, dimension(3, nbs, 6), parameter :: sg = reshape( &
                        [3.6769e-07, - 3.2010e-09,  2.6854e-10, &
                         1.2102e-08,  1.4819e-08, - 1.2528e-10, &
                         - 1.8040e-09,  8.0960e-09, - 8.3337e-11, &
                         - 3.8916e-09,  3.0980e-09, - 5.2653e-11, &
                         2.7871e-06,  5.9580e-08,  3.9106e-10, &
                         1.2476e-07,  1.4724e-07, - 1.2371e-09, &
                         - 1.6990e-08,  8.0839e-08, - 8.3064e-10, &
                         - 3.8826e-08,  3.0973e-08, - 5.2629e-10, &
                         8.1028e-06,  2.0695e-06, - 2.5828e-08, &
                         1.4059e-06,  1.4163e-06, - 1.1119e-08, &
                         - 1.6813e-07,  8.0769e-07, - 8.2991e-09, &
                         - 3.8900e-07,  3.0980e-07, - 5.2646e-09, &
                         1.8825e-05,  2.2827e-05, - 2.9290e-07, &
                         1.3962e-05,  1.2948e-05, - 8.4268e-08, &
                         - 1.5067e-06,  8.0048e-06, - 8.1870e-08, &
                         - 3.8863e-06,  3.0970e-06, - 5.2649e-08, &
                         8.3560e-05,  2.0913e-04, - 2.7313e-06, &
                         1.5178e-04,  1.1241e-04, - 6.0723e-07, &
                         - 4.3066e-06,  7.5855e-05, - 7.6008e-07, &
                         - 3.8533e-05,  3.0873e-05, - 5.2690e-07, &
                         5.6363e-04,  1.7611e-03, - 2.9519e-05, &
                         1.5129e-03,  9.0262e-04, - 5.9022e-06, &
                         1.6402e-04,  6.5347e-04, - 7.0118e-06, &
                         - 3.5615e-04,  2.9999e-04, - 5.3059e-06], [3, nbs, 6])
  !
end module datcldop4
!> \file
!> This is an example of adding text at the end of the routine.
!! Your detailed description of the routine can be put here, including scientific
!! numerics, and another other important information.
!! Doxygen should be able to translate LaTeX and it is possible to include
!! references using "\cite", for example, \cite vonSalzen2013.
!! Equations can be included as well, as inline equations \f$ F=ma \f$,
!! or in the equation environment \n
!! (NOTE that HTML will not number the equation but it will in LaTeX),
!! \f{equation}{
!!  F_1=ma_1
!! \f}
